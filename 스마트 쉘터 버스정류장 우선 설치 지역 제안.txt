스마트 쉘터 버스정류장 우선 설치 지역 제안
팀명 : 2분반 1조
프로젝트 목적
- 이 프로젝트는 서울시에서 시범운영하였던 스마트 쉘터 버스 정류장이 8월을 끝으로 시범운영이 종료되고 추후 추가 설치시 우선 지역을 제안하기 위한 프로젝트이다. 스마트 쉘터의 미세먼지 완화, 냉난방 조절, 교통약자 편의성 증대 기능을 활용하기 위해 버스 사용 유동인구와 교통약자, 기후 데이터를 통해 우선 지역을 제안.

개발환경
- 이 프로젝트는 Google Colaboratory 환경에서 진행되었으며 추후 다른 환경에서 확인 필요시 필요한 라이브러리 설치 및 raw data 경로 지정 과정이 필요함을 명시함. 


코드 사용법(다음 코드들은 모두 Google Colaboratory 환경에서 작성되어 다른 환경에서 실행 시 라이브러리 설치 과정이 필요할 수 있음)

데이터 전처리 코드 설명
시리얼 번호 위도 경도 행정구역 맵핑.ipynb
- 위 코드의 목적은 주어진 위도와 경도 정보를 이용하여 해당 위치의 행정구역 명칭을 얻는 역 지오코딩 작업을 수행
- 추후 행정동을 시리얼 코드로 가지고 있는 폭염, 미세먼지 데이터를 행정동 단위 주소 변환하기 위해 사용
- 결과 : 지역별_시리얼번호.csv

자치구_행정동_전처리.ipynb
- 위 코드의 목적은 2023년도의 S-DoT 데이터와 한국행정구역코드를 전처리하여, 2020, 2021, 2022년의 S-DoT의 시리얼에 대하여 자치구와 행정동을 매핑하기 위한 것
- 위 코드의 목적은 2022년도의 서울시 행정구역 동별 통계 데이터를 전처리하여, 서울시 행정동 리스트를 만들기 위한 것
- 결과 : 자치구_행정동_리스트.csv 

버스정류장_위치_전처리.ipynb
- 위 코드는 2019,2022,2023년도 버스정류소 위치 정보(위도,경도)정보가 담겨 있는 데이터를 사용해 지오코딩을 통해 버스정류소별 주소를 찾기위함
- 위치 오류를 전처리 하고 추후 버스정류소의 행정동을 추출해 행정동 단위 유동인구 파악하가 위해 사용
- 결과 : 2019,2022,2023 버스정류소위치_전처리.csv

행정동별_버스_유동인구_전처리.ipynb
- 위 코드는 2019,2022년도와 2023년 6월 까지의 버스 정류장별 일일 승하차 승객수 데이터를 사용하여 유동인구 데이터의 전처리 수행
- 위 결과물인 버스정류소위치_최종.csv 와 버스정류소 고유아이디(ARS-ID)를 활용하여 맵핑 후 행정동 별 유동인구 파악
- 전처리 오류 및 수정 값 전처리
- 결과: 2019,2022,2023 행정동별버스유동인구_전처리.csv

만65세이상_전처리.ipynb
- 위 코드의 목적은 2020, 2021, 2022년의 서울시 만 65세 이상 거주자 수 데이터를 전처리하고, 서울시 내 행정구역에서의 만 65세 이상 거주자 수를 분석
- 명칭이 변경된 행정동 데이터 전처리
- 결과 : 2020_2021_2022년도_만65세이상_거주자.csv

서울 행정구역별 12세미만 (2020~ 2022).ipynb
- 위 코드의 목적은 2020, 2021, 2022년의 서울시 만 12세 미만 거주자 수 데이터를 전처리하고, 서울시 내 행정구역에서의 만 12세 미만 거주자 수를 분석
- 명칭이 변경된 행정동 데이터 전처리
- 결과 : 12세 미만 인구 426row.csv

2022_서울시_장애인_인구_수_전처리.ipynb
- 위 코드의 목적은 2022년도 서울시 내 각 행정동별로 장애 유형별 장애인 거주자 수 데이터를 전처리하고, 서울지 내 행정동 별 장애인 거주자 수 분석
- 결과 : 2022년도_장애인_전처리.csv

날씨_전처리.ipynb
- 위 코드의 목적은 2020, 2021, 2022년 동안 여름 동안 온도와 습도 데이터를 전처리하고, 서울시 내 행정구역에서의 폭염의 빈도와 강도를 분석하기 위한 것
- 2020년, 2021년, 그리고 2022년의 여름기간 동안의 행정구역별로 폭염 빈도와 강도를 계산하는 방법을 보여줌
- 결과 : 2020_년도_폭염빈도_강도.csv,2021_년도_폭염빈도_강도.csv,2022_년도_폭염빈도_강도.csv

서울시 동별 대기오염(2022).ipynb
- 위 코드는 S-DoT 데이터의 미세먼지 데이터를 전처리하고, 2022년 동안 각 지역의 초미세먼지와 미세먼지 농도가 '나쁨' 범주 이상에 속하는 빈도를 계산하여 미세먼지 데이터 분석.
- 기상청 자료에 근거하여, 초미세먼지와 미세먼지 농도가 '나쁨' 수준 이상에 속하는 빈도를 계산.
- 계산된 미세먼지 빈도를 각 지역에 맞게 자치구_행정동_리스트.csv 데이터와 병합하고, 결측치가 있는 경우 평균값으로 처리.
- 결과 : 2022년도_(초)미세먼지나쁨빈도_전처리.csv


모델링 코드 설명
이 코드는 2022년도 전처리 데이터를 로드하고 추가 전처리한 후, 데이터 분포도를 통해 데이터 스케일러 선택 과정과 클러스터 수를 결정하기 위해 엘보우 메소드와 실루엣 스코어를 사용하는 과정을 보여줌. 이 코드를 기반으로 데이터 분석 및 클러스터링을 수행. 분류된 군집화의 공통된 행정동을 찾아 추후 추천 지역을 선정하기위해 사용.

변수 간 상관관계.ipynb
- 다음 코드는 모델링 전의 변수들간의 상관계수를 파악하여 상관관계가 높은 변수들을 통합하거나 제거하기 위한 목적으로 사용
- 변수들 간의 상관관계를 시각화로 표현하여 한 눈에 파악

데이터 로드 및 전처리
- 데이터를 로드하고 필요한 변수에 할당.
- 데이터의 칼럼명을 변경하거나 선택하고, 데이터를 병합.
- 데이터 따라 필요한 새로운 변수를 생성하고, 불필요한 변수를 제거.

데이터 스케일러 결정
- 모델링에 사용할 변수들을 RobustScaler, MinMaxScaler, StandardScaler 각 스케일러들을 통해 각 방법으로 스케일링 된 변수들의 데이터 분포를 파악.
- 각 스케일러를 적용한 데이터 분포를 KDE(Kernel Density Estimate) 그래프로 시각화.
- 다음 데이터 분포 시각화를 통해 데이터 분포를 파악 후 가장 고르게 분포된 RobustScaler를 선택.

데이터 스케일링
- 데이터를 스케일링하기 위해 RobustScaler를 적용.

클러스터 수 결정 - 엘보우 메소드
- Elbow Method를 사용하여 클러스터 개수 결정을 위한 그래프를 시각화.
- 각 클러스터링 방법(K-means,Gaussian Mixsture Mode, Hierarchical K-Means, K-medoids)의 알고리즘을 사용하여 클러스터링을 수행하고, 클러스터 개수에 따른 inertia 값을 저장.
- inertia 값의 변화를 시각화하여 엘보우 그래프를 확인.

클러스터 수 결정 - 실루엣 스코어
- Silhouette Score를 사용하여 클러스터 개수 결정을 수행.
- 각 클러스터링 방법의알고리즘을 사용하여 클러스터링을 수행하고, 클러스터링 결과의 실루엣 스코어를 계산.
- 다양한 클러스터 개수에 대해 실루엣 스코어를 계산하고, 가장 높은 스코어를 가진 클러스터 개수를 선택.

다음의 과정을 통해 K-means : 2개, Gaussian Mixsture Mode : 2개, Hierarchical K-Means : 2개, K-medoids : 3개 의 클러스터 개수를 결정.


클러스터링 코드 설명
해당 코드는 K-means,Gaussian Mixsture Mode, Hierarchical K-Means, K-medoids 클러스터링을 수행하여 데이터를 클러스터링하고, 그 결과를 시각화하며 각 클러스터의 특징을 분석하는 과정을 보여준다.

클러스터링 수행
- 클러스터링 모델에 사용할 데이터의 변수 선택하여 features 데이터프레임을 형성.
- RobustScaler를 사용하여 데이터를 스케일 조정하고, scaled_df 데이터프레임을 생성.
- 클러스터링 모델을 정의하고, 스케일 조정된 데이터에 대해 클러스터링을 수행하여 군집화.

클러스터 가중치 및 가중합 계산
- 이 코드는 더욱 유의미한 군집을 선택하기 위한 과정.
- 각 특징에 가중치를 부여하고, 가중합 컬럼을 생성.
- 클러스터 별로 가중합을 합산한 결과를 유의미한 군집을 선택하는데 사용.

PCA를 사용한 데이터 시각화
- 해당 부분은 좀 더 시각적으로 보기 편하게 하기위해 차원 축소를 진행.
- PCA를 사용하여 데이터를 2차원으로 축소하고, 축소된 결과를 PCA1과 PCA2 컬럼에 추가.
- 클러스터링 결과를 2차원 공간에 시각화.

클러스터 내부 및 외부 거리 평가
- 클러스터 내부 거리 평균과 클러스터 간 거리 평균을 계산합.
- 각 클러스터의 내부와 외부 거리 평균을 출력.
- 각 클러스터의 내부 거리 평균은 추후 구별된 군집화를 선택하는 기준으로 사용. 

클러스터 결정 및 행정동 목록 저장
- 특정 클러스터에 속하는 행정동 목록을 추출하여 '클러스터이름'_list에 저장.
- 이 코드를 바탕으로 데이터의 특성을 파악하고 클러스터링을 수행한 결과를 시각화 및 분석.
- 다음 결과로 각 클러스터에 공통으로 속한 행정동을 파악하는데 사용.


위와 같은 방법으로 Gaussian Mixture, Hierarchical K-means, K-medoids 모델로 클러스터링 수행. 

공통 클러스터 행정동 추가 분석
이 코드 부분은 네 가지 다른 클러스터링 모델의 결과로부터 공통으로 추출된 행정동을 활용하여 추가적인 분석을 수행하는 과정을 보여줌.

공통 행정동 추출
- 네 가지 클러스터링 모델(K-means, Gaussian Mixture, Hierarchical K-means, K-medoids)의 결과로부터 공통으로 나타나는 행정동을 추출.
- 추출된 행정동은 result 변수에 저장.

데이터 준비 및 스케일링
- 추출된 행정동을 기반으로 원본 데이터에서 해당 행정동 데이터를 추출.
- 추출된 데이터의 특정 피처들을 RobustScaler를 사용하여 스케일링 진행.

가중치 부여 및 가중합 계산
- 위 코드 부분은 우선 지역 순위부여하기 위한 가중치 부여 및 가중합 계산이다.
- 추출된 데이터의 특정 피처들에 가중치를 부여합니다. 이때 가중치의 합은 1이 되도록 조정.
- 각 데이터의 피처별 가중치 부여 후, 가중합을 계산하여 새로운 컬럼으로 추가.

데이터 정렬 및 추출
- 가중합을 기준으로 데이터를 정렬.
- 상위 30개 데이터를 추출하여 final_df에 저장.

자치구 및 행정동 정보 추가
- ex 데이터프레임에서 자치구와 행정동 정보를 추출하여 final_df에 추가.
추가 분석
- 가중합을 기준으로 정렬된 final_df를 활용하여 다양한 추가 분석을 수행.
특정 변수(유동인구, 폭염빈도, 미세먼지수준, 교통약자)를 기준으로 정렬하여 상위 3개의 행정동을 추출하는 등의 분석을 수행.
